---
title: "Sourceryに入門した"
emoji: "🐣"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["Swift"]
published: false
---

## 既存のファイルの指定した場所にコードを自動生成するパターン

### ファイルのモジュールのタイプと場所を決める
自動生成されるコードがモジュール内部の場合，モジュールのタイプを指定する必要がある．モジュールがクラスの場合，`for type in types.classes`，構造体の場合は`for type in types.structs`，列挙型の場合は`for type in types.enums`，プロトコルの場合は`for type in types.protocols`となる．
```sample1.stencil
{% for type in types.classes %}
//sourcery:inline::{{ type.name }}.TemplateName

//sourcery:end
{% forend %}
```
これで`//sourcery:`の間に書かれたコードが自動生成の対象となる．

### 引数とその扱いを指定する
sourceryでは引数をargumentパラメータとして入力できる．
```
{% for key, value in argument %}

{% for end}
```
key,valueでワンセットのイメージ(?)，`value in argument`ではなくて，`key, value in argument`

arugumentパラメータで入力した値`key=value`は，.stencilファイル内ではそれぞれ`{{key}`,`{{value}}`として扱われる．
```
let {{key}}Label: {{value}}
```

以上をまとめると
```sample.stencil
{% for type in types.classes %}
//sourcery:inline::{{ type.name }}.TemplateName
{% for key, value in argument %}
let {{key}}Label: {{value}}
{% for end}
//sourcery:end
{% forend %}
```
について
```
sourcery --sources SomeApp/Generated/SomeViewController.generated.swift --templates SomeApp/sample.stencil --output SomeApp/Generated/SampleViewController.generated.swift --args titile=String
```
をターミナルで実行することで
```SampleViewController.generated.swift
class SomeViewController: UIViewController {

}
```
が
```SampleViewController.generated.swift
class SomeViewController: UIViewController {
let titleLabel: String    
}
```
となる．

## コードだけでなくファイルごと自動生成するパターン
###